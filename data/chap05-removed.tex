\iffalse

% 现有体系结构共享性能很差
由于缺少有效的硬件资源共享管理机制，现有服务器体系结构不能很好的在共享场景中工作。
不同应用无管理的访问共享硬件资源，产生资源竞争并造成严重的性能干扰，进而影响应用性能，
来自Intel的研究\cite{intel}表明在共享末级缓存上的资源竞争最多可造成30\%的性能干扰。
% 而现实需求又需要共享
随着计算机硬件技术不断发展，现在计算机所能提供的硬件资源不断增加，
单个应用很难充分利用全部硬件资源；
与此同时，云计算与移动互联网的发展与普及，应用的数量也在飞速增加。
通过虚拟化与容器等技术将不同应用运行在同一台服务器，提高服务器资源利用率，
应用共享硬件资源成为常态。
% 资源利用率与服务质量相冲突
%但应用服务质量与服务器资源率之间存在冲突，
在这种场景下为了保障延迟敏感型应用的性能不受影响，
这些延迟敏感型应用需要独占部分共享资源（如部署在单独的服务器\cite{}），
这造成数据中心服务器的资源利用率通常只有10\%-12\%。
如何为硬件资源提供灵活的共享管理方法，是解决服务器多应用共享的关键问题。


% 问题一：资源竞争点不断变化，需要统一的管理接口，control plane + ?PRM?
现有一些研究工作在单一硬件资源上提出共享管理的方法，
如在共享末级缓存上提出容量划分的方法\cite{}，
在内存控制器上提供请求调度的方法\cite{}，
Intel在其Xeon E5v3系列处理器中增加了末级缓存容量划分功能。
但是计算机内包含大量的共享硬件资源，不同应用混合后，会在不同的硬件上资源上产生竞争；
同时由于硬件资源之间存在关联，需要协调管理。
例如仅通过容量划分的方式解决在共享缓存中的资源竞争，
可能会造成在竞争点转移到内存控制器，这是由于
因此，为所有的硬件资源提供统一的共享管理接口，
并集中式的管理节点内的全部共享资源是必要的。

%
要实现硬件资源的共享管理，首先需要考虑如何监控资源用量，以及实时反馈。 % stab+ttab
现有体系结构实现中已实现的监控大都是针对片内资源，如处理器核IPC、分支预测正确率、XXX等，
或缓存缺失率等信息，但这些信息都需要操作系统或库的支持，手动获取信息，无法实现实时的监控，
更无法实现实时反馈；而且这些信息通常是以处理器核做为区分，而无法直接映射到应用，
即无法直接获取应用相关的信息，需要软件进行预处理或后处理才能得到，通常这个时间是微秒甚至是秒级的；
当前数据中心需要高速的响应，因此如何实现毫秒级的资源监控与反馈是实现细粒度资源管理的基础。
本文所提出的控制平面中直接包含了用于收集硬件资源使用情况的硬件逻辑，
能够实现实时的性能监控，同时提供了性能条件触发逻辑，对资源使用变化进行实时的反馈。

对于硬件，如何实现干扰隔离。 % cp_proc

本文提出一种通用的硬件控制平面方法，为共享硬件资源提供共享资源管理的功能，具体包括:
基于表的资源管理抽象，实时性能监控与反馈，资源调整机制，可编程数据平面处理器。
与之前工作的主要区别是，（1）统一的资源抽象，而不是为单独某一个硬件资源；
（2）基于硬件的实时资源监控（3）

XXXX

xxx

XXXX

本章主要
%In this chapter I focus on the failure recovery, metadata I/O efficiency, and adaptability
%implications of the combined approach to metadata storage, journaling, and workload
%distribution and relate my experiences constructing a working implementation. I analyze a
%variety of static file system snapshots and workload traces to motivate MDS design and performance
%analysis, present a simulation based-analysis of metadata partitioning approaches to
%demonstrate the architectural advantages of a dynamic subtree-based approach, and evaluate
%my implementation under a range of micro-benchmarks, workload traces, and failure scenarios.


%这种多应用共享的使用方式在现有的服务器架构下会造成应用之间严重的干扰。
%为了防止这些硬件层次的干扰对延迟敏感型应用的性能造成影响，
%通常不会允许其他应用与延迟敏感型应用共享服务器资源，
%造成很低的服务器资源利用率。

% text from crad paper
% Reference
%   [17-19] \cite{bojnordi_pardis:_2012, martin2009, kornaros2003}
%   [20-23] \cite{kuskin1994, reinhardt1994, impulse1999, pong1998}
%   [24-27] \cite{p4_2014, song2013, jeyakumar2013, sivaraman2013}
%之前的工作PARD[16]提出了一种资源管理可编程体系结构，通过在计算机内部请求上附加应用标签，在共享部件中实现应用区分；并通过控制平面对来自不同应用的请求进行不同的处理，实现在同一服务器上为不同应用提供区分化服务；同时提供集中式的资源管理平台，实现对不同部件的资源使用进行统一管理。但它使用的基于表的控制平面设计并不能很好的适应应用需求的变化，这种设计只提供了对硬件已有功能的配置，需要在硬件部件上静态实现这些功能并对外提供配置接口，且功能一旦实现，无法根据应用的需求进行调整。
%然而在实际场景中，应用会对底层的硬件不断提出不同的需求，如更换Cache控制器的缓存替换策略、更改内存控制器的地址映射方式与调度策略、为I/O控制器增加数据加密或压缩的功能等。当前的这种静态的数据平面设计不能很好的满足这类需求，需要更换硬件才能实现，而这需要很长的周期，无法适应数据中心这种需要不断变化的场景。
%在学术界中，已有一些研究通过在硬件上增加可编程机制，实现根据应用需求对硬件策略进行调整的功能。如在体系结构领域已经提出的在内存控制器[17, 18,19]、Cache与一致性协议[20,21,22,23]上使用可编程逻辑来提供更灵活的功能，但这些只考虑了如何为单一应用提供更多的可编程支持，不能很好的在数据中心这种多应用场景下使用。在网络领域中也有工作提出在SDN数据平面上增加可编程逻辑的方案，以提高SDN数据平面的可编程性[24,25,26,27]，通过数据平面的重编程，达到对更多数据包的检测与处理的目的。PARD的一个重要贡献是将网络概念引入计算机体系结构，本文希望将SDN数据平面中这种高级的可编程机制引入到计算机体系结构中，实现更灵活的控制。
%综上，本文提出了一种体系结构内可编程数据平面架构，通过在硬件部件中增加处理器逻辑，使用执行固件代码的方式对硬件部件的请求进行处理，并通过更新数据平面处理器固件的方式实现数据平面功能的扩展，以增强计算机体系结构的可编程灵活度，使其能够适应更加复杂多变的数据中心应用场景。



\section{背景与相关工作}

现在的计算机中包括多种共享硬件资源，这些硬件又通过共享的数据通路相连，
需要一种共享资源管理机制来保障多应用共享时不会造成应用之间的干扰。
已有大量工作研究在不同的部件上支持多应用共享管理，本节将讨论其中一些工作，并分析共享管理中的难点。


\subsection{共享硬件资源管理的难点}
1，怎么算好的共享管理
2，需要什么样的接口
3，实时监控是个难点
4，全局调节是个总是（在下一章中解决）


\fi
